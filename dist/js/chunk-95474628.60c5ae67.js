(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-95474628"],{"45f1":function(e,t,n){"use strict";var a=n("b6a3");n.n(a).a},"57b8":function(e,t,n){e.exports=n.p+"img/schoolCard.9394d4b7.png"},6626:function(e,t,n){},b6a3:function(e,t,n){},ccc3:function(e,t,n){"use strict";var a=n("6626");n.n(a).a},ded2:function(e,t,n){e.exports=n.p+"img/card.cb7048a5.png"},e37e:function(e,t,n){"use strict";n.r(t);var a=(n("ac4d"),n("8a81"),n("ac6a"),n("f751"),n("96cf"),n("1da1")),s=n("be94"),o=n("2f62"),r={props:{autoComplete:{type:String,default:"off"},model:String,index:null,disabled:{type:Boolean,default:!1},accept:{type:String,default:"image/*"}},methods:{onRead:function(){var e=Object(a.a)(regeneratorRuntime.mark(function e(t,n,a){var s,o,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(s=t.target.files||t.dataTransfer.files)[0]){e.next=10;break}if(!(s[0].size/1024/1024>9)){e.next=6;break}this.$emit("onRead",!1),e.next=10;break;case 6:return o=new FileReader,e.next=9,o.readAsDataURL(s[0]);case 9:o.onload=function(e){r.$emit("onRead",{model:n,index:a,file:s[0],result:e.target.result,event:e}),r.$refs.inputFile.value=""};case 10:case"end":return e.stop()}},e,this)}));return function(t,n,a){return e.apply(this,arguments)}}(),getFile:function(){this.$refs.inputFile.click()}}},i=(n("45f1"),n("2877")),l=Object(i.a)(r,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fileAll"},[n("label",[e._t("default"),n("input",e._b({ref:"inputFile",staticClass:"fileClass",attrs:{type:"file",accept:e.accept},on:{change:function(t){e.onRead(t,e.model,e.index)}}},"input",e.$props,!1))],2)])},[],!1,null,"91636c5a",null);l.options.__file="file.vue";var c=l.exports,d=n("365c"),u=n("4360"),p=n("0f06").api,f={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){u.a.state.upload=100*(e.loaded/e.total).toFixed(2)}},h=function(e){return d.a.post("".concat(p,"/saveFile"),e,f)},m=n("e526"),_=n("ded2"),b=n.n(_),v=n("57b8"),x=n.n(v),g={components:{sxFile:c},data:function(){return{models:{real_name:null,sex:null,school_id:null,hostel_id:null,floor_id:null,card_type:1,card_path:null,card_view:null},modelsData:{school_id:null,hostel_id:null},modelsContrast:{real_name:"姓名",sex:"性别",school_id:"学校",hostel_id:"宿舍",card_type:"证件类型",card_path:"图片"},sexOptions:[{value:1,label:"男",text:"男"},{value:2,label:"女",text:"女"}],cardOptions:[{label:"身份证",value:1},{label:"学生证",value:2}],disabled:!1,flag:!1}},computed:Object(s.a)({},Object(o.c)(["user","upload","school","dormitory"])),watch:{school:function(e){this.models.school_id=e.school_id,this.$set(this.models,"school_name",e.school_name)},dormitory:function(e){this.$set(this.models,"floor_name",e[0].floor_name),this.$set(this.models,"floor_id",e[0].floor_id),this.$set(this.models,"hostel_id",e[1].hostel_id),this.$set(this.models,"hostel_name",e[1].hostel_name)}},created:function(){this.firstShow()},methods:Object(s.a)({},Object(o.b)(["setUpload","setBeforeInfo"]),{closeWindow:function(){"undefined"!=typeof WeixinJSBridge?WeixinJSBridge.call("closeWindow"):navigator.userAgent.indexOf("MSIE")>0?navigator.userAgent.indexOf("MSIE 6.0")>0?(window.opener=null,window.close()):(window.open("","_top"),window.top.close()):navigator.userAgent.indexOf("Firefox")>0?window.location.href="about:blank ":(window.opener=null,window.open("","_self",""),window.close())},firstShow:function(){var e=Object(a.a)(regeneratorRuntime.mark(function e(){var t,n,a,s,o,r,i,l,c,d,u,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.f)(this.user);case 2:return 400===(t=e.sent).data.return_code&&this.$createDialog({type:"alert",content:t.data.return_msg,onConfirm:function(){this.closeWindow()}}).show(),e.next=7,Object.assign(this.models,t.data.return_data);case 7:if(this.models=e.sent,this.models.sex||(this.models.sex=1),this.models.card_path&&(this.flag=!0),0===t.data.return_data.status&&(this.disabled=!0),!this.disabled){e.next=50;break}for(n=!0,a=!1,s=void 0,e.prev=15,o=this.sexOptions[Symbol.iterator]();!(n=(r=o.next()).done);n=!0)r.value.disabled=this.disabled;e.next=23;break;case 19:e.prev=19,e.t0=e.catch(15),a=!0,s=e.t0;case 23:e.prev=23,e.prev=24,n||null==o.return||o.return();case 26:if(e.prev=26,!a){e.next=29;break}throw s;case 29:return e.finish(26);case 30:return e.finish(23);case 31:for(i=!0,l=!1,c=void 0,e.prev=34,d=this.cardOptions[Symbol.iterator]();!(i=(u=d.next()).done);i=!0)u.value.disabled=this.disabled;e.next=42;break;case 38:e.prev=38,e.t1=e.catch(34),l=!0,c=e.t1;case 42:e.prev=42,e.prev=43,i||null==d.return||d.return();case 45:if(e.prev=45,!l){e.next=48;break}throw c;case 48:return e.finish(45);case 49:return e.finish(42);case 50:p="",e.t2=t.data.return_data.status,e.next=2===e.t2?54:57;break;case 54:return p=t.data.return_data.refuse_reason,this.$createDialog({type:"alert",title:"您认领盒子未通过申请",content:p}).show(),e.abrupt("break",58);case 57:return e.abrupt("return");case 58:case"end":return e.stop()}},e,this,[[15,19,23,31],[24,,26,30],[34,38,42,50],[43,,45,49]])}));return function(){return e.apply(this,arguments)}}(),getFile:function(){var e=this;this.$createDialog({type:"alert",confirmBtn:{text:"我知道了",active:!0},onConfirm:function(){e.$refs.file.getFile()}},function(t){var n=t("div",{style:{background:"#FFDF0A",borderRadius:"50%",width:"8px",height:"8px",marginRight:"8px"}});return[t("div",{style:{fontSize:"14px",padding:"10px"},slot:"title"},[t("p","证件上传示例")]),t("div",{style:{textAlign:"center",height:"160px"},slot:"content"},[t("img",{attrs:{src:1===e.models.card_type?b.a:x.a},style:{width:"86%",maxHeight:"130px"}}),t("div",{style:{margin:"auto",display:"flex",justifyContent:"space-between",alignItems:"center",height:"20px",width:"86%"}},[t("div",{style:{display:"flex",alignItems:"center"}},[n,"四角完整"]),t("p",{style:{display:"flex",alignItems:"center"}},[n,"亮度均匀"]),t("p",{style:{display:"flex",alignItems:"center"}},[n,"照片清晰"])])])]}).show()},submit:function(){var e=Object(a.a)(regeneratorRuntime.mark(function e(){var t,n,s,o,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=regeneratorRuntime.keys(this.modelsContrast);case 1:if((e.t1=e.t0()).done){e.next=8;break}if(t=e.t1.value,this.models[t]){e.next=6;break}return e.abrupt("return",this.$createToast({txt:"".concat(this.modelsContrast[t],"不能为空"),type:"txt"}).show());case 6:e.next=1;break;case 8:return(n=this.$createToast({time:0})).show(),e.next=12,Object(m.e)(this.models);case 12:s=e.sent,n.hide(),200!==s.data.return_code?(o=this,this.$createDialog({type:"confirm",content:"学校尚未开通 是否要加入我们",confirmBtn:{text:"是",active:!0,disabled:!1,href:"javascript:;"},cancelBtn:{text:"否",active:!1,disabled:!1,href:"javascript:;"},onConfirm:function(){var e=Object(a.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.a)(Object.assign({},r.user,r.models,{order_origin:4}));case 2:if(200!==(t=e.sent).data.return_code){e.next=8;break}o.$createDialog({type:"alert",content:"稍后会有客服与您联系"}).show(),e.next=9;break;case 8:return e.abrupt("return",o.$createToast({txt:t.data.return_msg,type:"txt"}).show());case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),onCancel:function(){}}).show()):(this.setBeforeInfo(this.models),this.$router.push("goodsBox"));case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),choiceSchool:function(){this.disabled||this.$router.push({name:"chooseSchool0",params:{id:"111112323"}})},choiceDormitory:function(){if(!this.disabled)return this.school?void this.$router.push({name:"chooseDormitory"}):this.$createToast({txt:"请先选择学校",type:"txt"}).show()},onRead:function(){var e=Object(a.a)(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.flag=!0,(n=new FormData).append("save_path",t.file),n.append("user_id","16813"),n.append("login_token","e909d77a7d2d9fec5b0b5bfdccb495d5"),e.next=7,h(n);case 7:a=e.sent,this.setUpload(0),a&&(this.models.card_path=a.data.return_data.upload_path,this.models.card_view=a.data.return_data.view_path);case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),openSexChoose:function(){var e=this;this.$createPicker({data:[[{value:1,text:"男"},{value:2,text:"女"}]],onSelect:function(t){e.models.sex=t[0]}}).show()}}),mounted:function(){document.title="认领盒子"}},w=(n("ccc3"),Object(i.a)(g,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"all"},["info"===e.$route.name?n("div",{staticClass:"content"},[n("label",[n("p",[e._v(e._s(e.modelsContrast.real_name))]),n("cube-input",{attrs:{disabled:e.disabled,placeholder:"请与身份证姓名一致"},model:{value:e.models.real_name,callback:function(t){e.$set(e.models,"real_name",t)},expression:"models.real_name"}})],1),n("label",{staticClass:"sex"},[n("p",[e._v(e._s(e.modelsContrast.sex))]),n("div",{staticClass:"sexContent",on:{click:e.openSexChoose}},[e._v("\n        "+e._s(2===e.models.sex?"女":"男")+"\n      ")])]),n("label",[n("p",[e._v(e._s(e.modelsContrast.school_id))]),n("span",{class:{spanActive:Boolean(e.models.school_id)},on:{click:e.choiceSchool}},[e._v("\n      "+e._s(e.models.school_id?e.models.school_name:"选择学校 >"))])]),n("label",[n("p",[e._v(e._s(e.modelsContrast.hostel_id))]),n("span",{class:{spanActive:Boolean(e.models.hostel_id)},on:{click:e.choiceDormitory}},[e._v("\n    "+e._s(e.models.floor_id?e.models.floor_name+e.models.hostel_name:"选择宿舍 >"))])]),n("label",[n("p",[e._v(e._s(e.modelsContrast.card_type))]),n("cube-radio-group",{attrs:{options:e.cardOptions,horizontal:!0},model:{value:e.models.card_type,callback:function(t){e.$set(e.models,"card_type",t)},expression:"models.card_type"}})],1),n("p",{staticStyle:{width:"100%",height:"10px"}},[e._v("\n      "+e._s(e.models.real_name?"拍摄上传"+e.models.real_name+"的"+(1===e.models.card_type?"身份证":"学生证"):"")+"\n    ")]),n("div",{staticClass:"image",style:{backgroundImage:"url("+e.models.card_view+")"},on:{click:e.getFile}},[n("div",{class:{modal:!0,changeImage:e.flag}},[e.flag?e._e():n("i",{staticClass:"cubeic-add icon"}),e._v("\n        "+e._s(e.flag?e.upload?e.upload+"%":"点击替换":"点击上传")+"\n      ")])])]):e._e(),"info"===e.$route.name?n("div",{staticClass:"bottomText"},[e._m(0),n("cube-button",{attrs:{primary:!0,disabled:e.disabled},on:{click:e.submit}},[e._v("\n      "+e._s(0==e.models.status?"审核中":1===e.models.status?"成功认领":"重新申请")+"\n    ")])],1):n("router-view"),n("sx-file",{ref:"file",on:{onRead:e.onRead}})],1)},[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("i",{staticClass:"box-gantanhao_icon"}),e._v("\n      信息仅用于身份验证，盒里有保证您的信息安全\n    ")])}],!1,null,"342874a9",null));w.options.__file="index.vue",t.default=w.exports},e526:function(e,t,n){"use strict";n.d(t,"f",function(){return o}),n.d(t,"b",function(){return r}),n.d(t,"g",function(){return i}),n.d(t,"d",function(){return l}),n.d(t,"c",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"a",function(){return u});var a=n("365c"),s=n("0f06").api,o=function(e){return a.a.post("".concat(s,"/receiveInfo"),e)},r=function(e){return a.a.post("".concat(s,"/area"),e)},i=function(e){return a.a.post("".concat(s,"/schoolList"),e)},l=function(e){return a.a.post("".concat(s,"/hostelList"),e)},c=function(e){return a.a.post("".concat(s,"/floorList"),e)},d=function(e){return a.a.post("".concat(s,"/isExistOperator"),e)},u=function(e){return a.a.post("".concat(s,"/applyEnter"),e)}}}]);